---
# Add extra Kolla global configuration here.

# Tell kolla to use the extra volume in this location
nova_instance_datadir_volume: '/var/lib/nova'

# Make glance use a file backend
glance_backend_swift: "no"
glance_file_backend: "yes"

# Enable CADF notifications in Keystone
enable_cadf_notifications: "yes"

# Projects to extracts metrics from with cASO
#caso_projects:
#  - iris
#  - iris-euclid
caso_messengers:
  - caso.messenger.logstash.LogstashMessenger
  - caso.messenger.ssm.SSMMessengerV04
caso_site_name: "CHANGE_ME_CASO_SITE_NAME"

# Designate (DNSaaS) configuration
designate_backend: "bind9"
designate_ns_record: "CHANGEME_DESIGNATE_NS_RECORD"

# Default size causes ES to fall over very easily
{% if scientific_openstack_trait_all_in_one %}
es_heap_size: 8g
{% else %}
es_heap_size: "24g"
{% endif %}

# Look after elasticserach indexes, as required
enable_elasticsearch_curator: true
# Close index after 30 days
elasticsearch_curator_soft_retention_period_days: 30
# Hard delete index after around 3 years
elasticsearch_curator_hard_retention_period_days: 1100

# Takes longer than the default 10 seconds, we poll every 1m
prometheus_openstack_exporter_timeout: 30s

rabbitmq_remove_ha_all_policy: true

# Needed to launch VM instances in aio environment without nested virt
nova_compute_virt_type: "{{ 'qemu' if scientific_openstack_trait_all_in_one else 'kvm' }}"

# Increase the default prometheus retention period
prometheus_cmdline_extras: '--storage.tsdb.retention.time=90d --storage.tsdb.retention.size=50GB'

# Reduce the kolla-ansible token expiry default from one day to one hour
fernet_token_expiry: 3600

# Custom exporters
enable_prometheus_libvirt_exporter: True

# Using gitlab registry with TLS
docker_registry_insecure: false

{% if scientific_openstack_trait_all_in_one %}
keepalived_vip_prechecks: false
{% endif %}

{% if scientific_openstack_trait_ovn %}
neutron_plugin_agent: 'ovn'
{% endif %}

#FIXME: new container images need
libvirt_enable_sasl: false

# On EL8 use kayobe configured docker repo
enable_docker_repo: false

enable_prometheus_libvirt_exporter: "yes"

# Disable kolla managed NTP clients
enable_chrony: false
enable_host_ntp: false

# This is templated on localhost, so use raw tags.
enable_nova_libvirt_container: "{% raw %}{{ ansible_facts.distribution != 'Rocky' }}{% endraw %}"

# Custom container image tags.
# These should be allowed to change independently, as services are updated.
# If there are no custom images this comment serves as a placeholder
