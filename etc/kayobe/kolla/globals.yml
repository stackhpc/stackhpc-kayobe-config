# yamllint disable-file
---
# Add extra Kolla global configuration here.


# Tell kolla to use the extra volume in this location
nova_instance_datadir_volume: '/var/lib/nova'

# Make glance use a file backend
glance_backend_swift: "no"
glance_file_backend: "yes"

# Enable CADF notifications in Keystone
enable_cadf_notifications: "yes"

# Projects to extracts metrics from with cASO
#caso_projects:
#  - iris
#  - iris-euclid
caso_messengers:
  - caso.messenger.logstash.LogstashMessenger
  - caso.messenger.ssm.SSMMessengerV04
caso_site_name: "CHANGE_ME_CASO_SITE_NAME"

# Designate (DNSaaS) configuration
designate_backend: "bind9"
designate_ns_record: "CHANGEME_DESIGNATE_NS_RECORD"

# Default size causes ES to fall over very easily
{% if scientific_openstack_trait_all_in_one %}
es_heap_size: 8g
{% else %}
es_heap_size: "24g"
{% endif %}

# Look after elasticserach indexes, as required
enable_elasticsearch_curator: true
# Close index after 30 days
elasticsearch_curator_soft_retention_period_days: 30
# Hard delete index after around 3 years
elasticsearch_curator_hard_retention_period_days: 1100

# Takes longer than the default 10 seconds, we poll every 1m
prometheus_openstack_exporter_timeout: 30s

rabbitmq_remove_ha_all_policy: true

# Needed to launch VM instances in aio environment without nested virt
nova_compute_virt_type: "{{ 'qemu' if scientific_openstack_trait_all_in_one else 'kvm' }}"

# Increase the default prometheus retention period
prometheus_cmdline_extras: '--storage.tsdb.retention.time=90d --storage.tsdb.retention.size=50GB'

# Reduce the kolla-ansible token expiry default from one day to one hour
fernet_token_expiry: 3600

# Custom exporters
enable_prometheus_libvirt_exporter: True

{% if scientific_openstack_trait_all_in_one %}
keepalived_vip_prechecks: false
{% endif %}

{% if scientific_openstack_trait_ovn %}
neutron_plugin_agent: 'ovn'
{% endif %}

# Disable kolla managed NTP clients
enable_chrony: false
enable_host_ntp: false

# Custom container image tags.
# These should be allowed to change independently, as services are updated.
# If there are no custom images this comment serves as a placeholder
{% if kolla_base_distro == 'centos' %}
bifrost_tag: wallaby-20230207T194135
blazar_tag: wallaby-20230303T172322
caso_tag: wallaby-20230303T172322
neutron_tag: wallaby-20230307T113517
{% else %}
bifrost_tag: wallaby-20230215T160405
blazar_tag: wallaby-20230303T172458
caso_tag: wallaby-20230303T172458
neutron_tag: wallaby-20230307T121824
{% endif %}
glance_tls_proxy_tag: "{% raw %}{{ haproxy_tag | default(openstack_tag) }}{% endraw %}"
neutron_tls_proxy_tag: "{% raw %}{{ haproxy_tag | default(openstack_tag) }}{% endraw %}"
