---
# Add extra Kolla global configuration here.

# Default size causes ES to fall over very easily
{% if scientific_openstack_trait_all_in_one %}
es_heap_size: 8g
{% else %}
es_heap_size: "24g"
{% endif %}

# Backport of: https://review.opendev.org/c/openstack/kolla-ansible/+/824994
# Upstream version isbackported to Victoria.
rabbitmq_remove_ha_all_policy: true

# Needed to launch VM instances in aio environment without nested virt
nova_compute_virt_type: "{{ 'qemu' if scientific_openstack_trait_all_in_one else 'kvm' }}"

# Using gitlab registry with TLS
docker_registry_insecure: false

{% if scientific_openstack_trait_all_in_one %}
keepalived_vip_prechecks: false
{% endif %}

{% if scientific_openstack_trait_ovn %}
neutron_plugin_agent: 'ovn'
{% endif %}

libvirt_enable_sasl: true

# Disable kolla managed NTP clients
enable_chrony: false
enable_host_ntp: false

# OpenStack Train: CentOS 7 to Rocky Linux 8 compatability
rabbitmq_use_3_7_24_on_centos7: true
elasticsearch_use_v6: true
kibana_use_v6: true

# This is templated on localhost, so use raw tags.
enable_nova_libvirt_container: "{% raw %}{{ ansible_facts.os_family == 'RedHat' and ansible_facts.distribution_major_version | int == 7 }}{% endraw %}"
