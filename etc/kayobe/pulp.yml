---
###############################################################################
# Local Pulp server configuration

# Base URL of the local Pulp service.
# Default uses the seed node's IP on the admin network.
pulp_url: "{{ 'https' if pulp_enable_tls | bool else 'http' }}://{{ admin_oc_net_name | net_ip(groups['seed'][0]) }}:{{ pulp_port }}"

# Port on the seed node's interface on the admin network that the Pulp service
# listens on.
pulp_port: "{{ '443' if pulp_enable_tls | bool else '80' }}"

# Whether to enable TLS for Pulp.
pulp_enable_tls: false

# Path to a TLS certificate to use when TLS is enabled.
#pulp_cert_path:

# Path to a TLS key to use when TLS is enabled.
#pulp_key_path:

###############################################################################
# Local Pulp access credentials

# Credentials used to access the local Pulp REST API.
pulp_username: admin
pulp_password: "{{ secrets_pulp_password }}"

# Proxy to use when adding remotes.
pulp_proxy_url: "{{ omit }}"

###############################################################################
# StackHPC Pulp server

# Base URL of the StackHPC Pulp service.
stackhpc_release_pulp_url: "https://ark.stackhpc.com"

# Credentials used to access the StackHPC Pulp service.
stackhpc_release_pulp_username:
stackhpc_release_pulp_password:

# Content URL of the StackHPC Pulp service.
stackhpc_release_pulp_content_url: "{{ stackhpc_release_pulp_url }}/pulp/content"

# Sync all repositories required for building Kolla images from the
# StackHPC Ark Pulp service to local Pulp.
# NOTE: Only RPM repositories are supported.
stackhpc_pulp_sync_for_local_container_build: false

###############################################################################
# Debs

# Whether to sync Ubuntu packages.
stackhpc_pulp_sync_ubuntu_focal: "{{ os_release == 'focal' }}"

stackhpc_pulp_repository_deb_repos:
  # Base Ubuntu Focal repositories
  - name: Ubuntu focal
    url: "{{ stackhpc_release_pulp_content_url }}/ubuntu/focal/{{ stackhpc_pulp_repo_ubuntu_focal_version }}"
    remote_username: "{{ stackhpc_release_pulp_username }}"
    remote_password: "{{ stackhpc_release_pulp_password }}"
    client_cert: ""
    client_key: ""
    policy: on_demand
    proxy_url: "{{ pulp_proxy_url }}"
    architectures: amd64
    components: main restricted universe multiverse
    distributions: focal focal-updates focal-backports
    mirror: true
    state: present
    required: "{{ stackhpc_pulp_sync_ubuntu_focal | bool }}"

  - name: Ubuntu focal security
    url: "{{ stackhpc_release_pulp_content_url }}/ubuntu/focal-security/{{ stackhpc_pulp_repo_ubuntu_focal_security_version }}"
    remote_username: "{{ stackhpc_release_pulp_username }}"
    remote_password: "{{ stackhpc_release_pulp_password }}"
    client_cert: ""
    client_key: ""
    policy: on_demand
    proxy_url: "{{ pulp_proxy_url }}"
    architectures: amd64
    components: main restricted universe multiverse
    distributions: focal-security
    mirror: true
    state: present
    required: "{{ stackhpc_pulp_sync_ubuntu_focal | bool }}"

  # Ubuntu Cloud Archive (UCA) repositories
  - name: Ubuntu Cloud Archive
    url: "{{ stackhpc_release_pulp_content_url }}/ubuntu-cloud-archive/{{ stackhpc_pulp_repo_ubuntu_cloud_archive_version }}"
    remote_username: "{{ stackhpc_release_pulp_username }}"
    remote_password: "{{ stackhpc_release_pulp_password }}"
    client_cert: ""
    client_key: ""
    policy: on_demand
    proxy_url: "{{ pulp_proxy_url }}"
    architectures: amd64
    components: main
    distributions: "focal-updates/{{ openstack_release }}"
    mirror: true
    state: present
    required: "{{ stackhpc_pulp_sync_ubuntu_focal | bool }}"

  # Third-party repositories
  - name: Docker CE for Ubuntu
    url: "{{ stackhpc_release_pulp_content_url }}/docker-ce/ubuntu/{{ stackhpc_pulp_repo_docker_ce_ubuntu_version }}"
    remote_username: "{{ stackhpc_release_pulp_username }}"
    remote_password: "{{ stackhpc_release_pulp_password }}"
    client_cert: ""
    client_key: ""
    policy: on_demand
    proxy_url: "{{ pulp_proxy_url }}"
    architectures: amd64
    distributions: focal
    components: stable
    mirror: true
    state: present
    required: "{{ stackhpc_pulp_sync_ubuntu_focal | bool }}"

# Publication format is a subset of distribution.
stackhpc_pulp_publication_deb_development: "{{ stackhpc_pulp_distribution_deb_development }}"

# Content is made available at well-known distribution names for development,
# production.

# Development tracks the release repositories.
stackhpc_pulp_distribution_deb_development:
  # Base Ubuntu Focal repositories
  - name: "ubuntu-focal-development"
    repository: Ubuntu focal
    base_path: "ubuntu/focal/development"
    mode: verbatim
    state: present
    required: "{{ stackhpc_pulp_sync_ubuntu_focal | bool }}"
  - name: "ubuntu-focal-security-development"
    repository: Ubuntu focal security
    base_path: "ubuntu/focal-security/development"
    mode: verbatim
    state: present
    required: "{{ stackhpc_pulp_sync_ubuntu_focal | bool }}"

  # Ubuntu Cloud Archive (UCA) repositories
  - name: "ubuntu-cloud-archive-development"
    repository: Ubuntu Cloud Archive
    base_path: "ubuntu-cloud-archive/development"
    mode: verbatim
    state: present
    required: "{{ stackhpc_pulp_sync_ubuntu_focal | bool }}"

  # Third-party repositories
  - name: "docker-ce-for-ubuntu-development"
    repository: Docker CE for Ubuntu
    base_path: "docker-ce/ubuntu/development"
    mode: verbatim
    state: present
    required: "{{ stackhpc_pulp_sync_ubuntu_focal | bool }}"

# Development gets promoted to production.
stackhpc_pulp_distribution_deb_production:
  # Base Ubuntu Focal repositories
  - name: "ubuntu-focal-production"
    repository: Ubuntu focal
    base_path: "ubuntu/focal/production"
    mode: verbatim
    state: present
    required: "{{ stackhpc_pulp_sync_ubuntu_focal | bool }}"
  - name: "ubuntu-focal-security-production"
    repository: Ubuntu focal security
    base_path: "ubuntu/focal-security/production"
    mode: verbatim
    state: present
    required: "{{ stackhpc_pulp_sync_ubuntu_focal | bool }}"

  # Ubuntu Cloud Archive (UCA) repositories
  - name: "ubuntu-cloud-archive-production"
    repository: Ubuntu Cloud Archive
    base_path: "ubuntu-cloud-archive/production"
    mode: verbatim
    state: present
    required: "{{ stackhpc_pulp_sync_ubuntu_focal | bool }}"

  # Third-party repositories
  - name: "docker-ce-for-ubuntu-production"
    repository: Docker CE for Ubuntu
    base_path: "docker-ce/ubuntu/production"
    mode: verbatim
    state: present
    required: "{{ stackhpc_pulp_sync_ubuntu_focal | bool }}"

###############################################################################
# RPMs

# Content comes in from release repositories, via pinned repo versions.

# Whether to sync CentOS Stream 8 packages.
stackhpc_pulp_sync_centos_stream8: "{{ os_distribution == 'centos' }}"

# Whether to sync Rocky Linux 8 packages.
stackhpc_pulp_sync_rocky_8: "{{ os_distribution == 'rocky' and os_release == '8' }}"
# Rocky 8 minor version number. Supported values: 6, 7
stackhpc_pulp_repo_rocky_8_minor_version: 7
# Rocky 8 Snapshot versions. The defaults use the appropriate version from
# pulp-repo-versions.yml for the selected minor release.
stackhpc_pulp_repo_rocky_8_appstream_version: "{{ lookup('vars', 'stackhpc_pulp_repo_rocky_8_%s_appstream_version' % stackhpc_pulp_repo_rocky_8_minor_version) }}"
stackhpc_pulp_repo_rocky_8_baseos_version: "{{ lookup('vars', 'stackhpc_pulp_repo_rocky_8_%s_baseos_version' % stackhpc_pulp_repo_rocky_8_minor_version) }}"
stackhpc_pulp_repo_rocky_8_extras_version: "{{ lookup('vars', 'stackhpc_pulp_repo_rocky_8_%s_extras_version' % stackhpc_pulp_repo_rocky_8_minor_version) }}"
stackhpc_pulp_repo_rocky_8_nfv_version: "{{ lookup('vars', 'stackhpc_pulp_repo_rocky_8_%s_nfv_version' % stackhpc_pulp_repo_rocky_8_minor_version) }}"
stackhpc_pulp_repo_rocky_8_powertools_version: "{{ lookup('vars', 'stackhpc_pulp_repo_rocky_8_%s_powertools_version' % stackhpc_pulp_repo_rocky_8_minor_version) }}"

# Whether to sync packages common to all RHEL 8 derivatives.
stackhpc_pulp_sync_el_8: "{{ stackhpc_pulp_sync_rocky_8 or stackhpc_pulp_sync_centos_stream8 }}"

# Whether to sync Rocky Linux 9 packages.
stackhpc_pulp_sync_rocky_9: "{{ os_distribution == 'rocky' and os_release == '9' }}"
# Rocky 9 minor version number. Supported values: 1
stackhpc_pulp_repo_rocky_9_minor_version: 1
# Rocky 9 Snapshot versions. The defaults use the appropriate version from
# pulp-repo-versions.yml for the selected minor release.
stackhpc_pulp_repo_rocky_9_appstream_version: "{{ lookup('vars', 'stackhpc_pulp_repo_rocky_9_%s_appstream_version' % stackhpc_pulp_repo_rocky_9_minor_version) }}"
stackhpc_pulp_repo_rocky_9_baseos_version: "{{ lookup('vars', 'stackhpc_pulp_repo_rocky_9_%s_baseos_version' % stackhpc_pulp_repo_rocky_9_minor_version) }}"
stackhpc_pulp_repo_rocky_9_extras_version: "{{ lookup('vars', 'stackhpc_pulp_repo_rocky_9_%s_extras_version' % stackhpc_pulp_repo_rocky_9_minor_version) }}"
stackhpc_pulp_repo_rocky_9_crb_version: "{{ lookup('vars', 'stackhpc_pulp_repo_rocky_9_%s_crb_version' % stackhpc_pulp_repo_rocky_9_minor_version) }}"
stackhpc_pulp_repo_rocky_9_highavailability_version: "{{ lookup('vars', 'stackhpc_pulp_repo_rocky_9_%s_highavailability_version' % stackhpc_pulp_repo_rocky_9_minor_version) }}"

# Whether to sync packages common to all RHEL 9 derivatives.
stackhpc_pulp_sync_el_9: "{{ stackhpc_pulp_sync_rocky_9 | bool }}"

stackhpc_pulp_repository_rpm_repos:
  # Base CentOS 8 Stream repositories
  - name: CentOS Stream 8 - AppStream
    url: "{{ stackhpc_release_pulp_content_url }}/centos/8-stream/AppStream/x86_64/os/{{ stackhpc_pulp_repo_centos_stream_8_appstream_version }}"
    remote_username: "{{ stackhpc_release_pulp_username }}"
    remote_password: "{{ stackhpc_release_pulp_password }}"
    client_cert: ""
    client_key: ""
    policy: on_demand
    proxy_url: "{{ pulp_proxy_url }}"
    sync_policy: mirror_complete
    state: present
    required: "{{ stackhpc_pulp_sync_centos_stream8 | bool }}"
  - name: CentOS Stream 8 - BaseOS
    url: "{{ stackhpc_release_pulp_content_url }}/centos/8-stream/BaseOS/x86_64/os/{{ stackhpc_pulp_repo_centos_stream_8_baseos_version }}"
    remote_username: "{{ stackhpc_release_pulp_username }}"
    remote_password: "{{ stackhpc_release_pulp_password }}"
    client_cert: ""
    client_key: ""
    policy: on_demand
    proxy_url: "{{ pulp_proxy_url }}"
    sync_policy: mirror_complete
    state: present
    required: "{{ stackhpc_pulp_sync_centos_stream8 | bool }}"
  - name: CentOS Stream 8 - Extras
    url: "{{ stackhpc_release_pulp_content_url }}/centos/8-stream/extras/x86_64/os/{{ stackhpc_pulp_repo_centos_stream_8_extras_version }}"
    remote_username: "{{ stackhpc_release_pulp_username }}"
    remote_password: "{{ stackhpc_release_pulp_password }}"
    client_cert: ""
    client_key: ""
    policy: on_demand
    proxy_url: "{{ pulp_proxy_url }}"
    sync_policy: mirror_complete
    state: present
    required: "{{ stackhpc_pulp_sync_centos_stream8 | bool }}"

  # Base Rocky 8 repositories
  - name: Rocky Linux 8 - AppStream
    url: "{{ stackhpc_release_pulp_content_url }}/rocky/8.{{ stackhpc_pulp_repo_rocky_8_minor_version }}/AppStream/x86_64/os/{{ stackhpc_pulp_repo_rocky_8_appstream_version }}"
    remote_username: "{{ stackhpc_release_pulp_username }}"
    remote_password: "{{ stackhpc_release_pulp_password }}"
    client_cert: ""
    client_key: ""
    policy: on_demand
    proxy_url: "{{ pulp_proxy_url }}"
    sync_policy: mirror_complete
    state: present
    required: "{{ stackhpc_pulp_sync_rocky_8 | bool }}"
  - name: Rocky Linux 8 - BaseOS
    url: "{{ stackhpc_release_pulp_content_url }}/rocky/8.{{ stackhpc_pulp_repo_rocky_8_minor_version }}/BaseOS/x86_64/os/{{ stackhpc_pulp_repo_rocky_8_baseos_version }}"
    remote_username: "{{ stackhpc_release_pulp_username }}"
    remote_password: "{{ stackhpc_release_pulp_password }}"
    client_cert: ""
    client_key: ""
    policy: on_demand
    proxy_url: "{{ pulp_proxy_url }}"
    sync_policy: mirror_complete
    state: present
    required: "{{ stackhpc_pulp_sync_rocky_8 | bool }}"
  - name: Rocky Linux 8 - Extras
    url: "{{ stackhpc_release_pulp_content_url }}/rocky/8.{{ stackhpc_pulp_repo_rocky_8_minor_version }}/extras/x86_64/os/{{ stackhpc_pulp_repo_rocky_8_extras_version }}"
    remote_username: "{{ stackhpc_release_pulp_username }}"
    remote_password: "{{ stackhpc_release_pulp_password }}"
    client_cert: ""
    client_key: ""
    policy: on_demand
    proxy_url: "{{ pulp_proxy_url }}"
    sync_policy: mirror_complete
    state: present
    required: "{{ stackhpc_pulp_sync_rocky_8 | bool }}"
  - name: Rocky Linux 8 - NFV
    url: "{{ stackhpc_release_pulp_content_url }}/rocky/8.{{ stackhpc_pulp_repo_rocky_8_minor_version }}/nfv/x86_64/os/{{ stackhpc_pulp_repo_rocky_8_nfv_version }}"
    remote_username: "{{ stackhpc_release_pulp_username }}"
    remote_password: "{{ stackhpc_release_pulp_password }}"
    client_cert: ""
    client_key: ""
    policy: on_demand
    proxy_url: "{{ pulp_proxy_url }}"
    sync_policy: mirror_complete
    state: present
    required: "{{ stackhpc_pulp_sync_rocky_8 | bool }}"
  - name: Rocky Linux 8 - PowerTools
    url: "{{ stackhpc_release_pulp_content_url }}/rocky/8.{{ stackhpc_pulp_repo_rocky_8_minor_version }}/PowerTools/x86_64/os/{{ stackhpc_pulp_repo_rocky_8_powertools_version }}"
    remote_username: "{{ stackhpc_release_pulp_username }}"
    remote_password: "{{ stackhpc_release_pulp_password }}"
    client_cert: ""
    client_key: ""
    policy: on_demand
    proxy_url: "{{ pulp_proxy_url }}"
    sync_policy: mirror_complete
    state: present
    required: "{{ stackhpc_pulp_sync_rocky_8 | bool }}"

  # EPEL 8 repositories
  - name: Extra Packages for Enterprise Linux 8 - x86_64
    url: "{{ stackhpc_release_pulp_content_url }}/epel/8/Everything/x86_64/{{ stackhpc_pulp_repo_epel_version }}"
    remote_username: "{{ stackhpc_release_pulp_username }}"
    remote_password: "{{ stackhpc_release_pulp_password }}"
    client_cert: ""
    client_key: ""
    policy: on_demand
    proxy_url: "{{ pulp_proxy_url }}"
    sync_policy: mirror_content_only
    state: present
    required: "{{ stackhpc_pulp_sync_el_8 | bool }}"
  - name: Extra Packages for Enterprise Linux Modular 8 - x86_64
    url: "{{ stackhpc_release_pulp_content_url }}/epel/8/Modular/x86_64/{{ stackhpc_pulp_repo_epel_modular_version }}"
    remote_username: "{{ stackhpc_release_pulp_username }}"
    remote_password: "{{ stackhpc_release_pulp_password }}"
    client_cert: ""
    client_key: ""
    policy: on_demand
    proxy_url: "{{ pulp_proxy_url }}"
    sync_policy: mirror_complete
    state: present
    required: "{{ stackhpc_pulp_sync_el_8 | bool }}"

  # Third-party repositories
  - name: Docker CE for CentOS 8
    url: "{{ stackhpc_release_pulp_content_url }}/docker-ce/centos/8/x86_64/stable/{{ stackhpc_pulp_repo_docker_version }}"
    remote_username: "{{ stackhpc_release_pulp_username }}"
    remote_password: "{{ stackhpc_release_pulp_password }}"
    client_cert: ""
    client_key: ""
    policy: on_demand
    proxy_url: "{{ pulp_proxy_url }}"
    sync_policy: mirror_complete
    state: present
    required: "{{ stackhpc_pulp_sync_el_8 }}"

  # Additional repositories required to build Kolla containers from local Pulp service.
  - name: CentOS Stream 8 - OpenStack Yoga
    url: "{{ stackhpc_release_pulp_content_url }}/centos/8-stream/cloud/x86_64/openstack-yoga/{{ stackhpc_pulp_repo_centos_stream_8_openstack_yoga_version }}"
    remote_username: "{{ stackhpc_release_pulp_username }}"
    remote_password: "{{ stackhpc_release_pulp_password }}"
    client_cert: ""
    client_key: ""
    policy: on_demand
    proxy_url: "{{ pulp_proxy_url }}"
    sync_policy: mirror_complete
    state: present
    required: "{{ stackhpc_pulp_sync_for_local_container_build | bool and stackhpc_pulp_sync_el_8 | bool }}"

  - name: CentOS Stream 8 - Advanced Virtualization
    url: "{{ stackhpc_release_pulp_content_url }}/centos/8-stream/virt/x86_64/advancedvirt-common/{{ stackhpc_pulp_repo_centos_stream_8_advanced_virtualization_version }}"
    remote_username: "{{ stackhpc_release_pulp_username }}"
    remote_password: "{{ stackhpc_release_pulp_password }}"
    client_cert: ""
    client_key: ""
    policy: on_demand
    proxy_url: "{{ pulp_proxy_url }}"
    sync_policy: mirror_complete
    state: present
    required: "{{ stackhpc_pulp_sync_for_local_container_build | bool and stackhpc_pulp_sync_el_8 | bool }}"

  - name: CentOS Stream 8 - NFV OpenvSwitch
    url: "{{ stackhpc_release_pulp_content_url }}/centos/8-stream/nfv/x86_64/openvswitch-2/{{ stackhpc_pulp_repo_centos_stream_8_nfv_openvswitch_version }}"
    remote_username: "{{ stackhpc_release_pulp_username }}"
    remote_password: "{{ stackhpc_release_pulp_password }}"
    client_cert: ""
    client_key: ""
    policy: on_demand
    proxy_url: "{{ pulp_proxy_url }}"
    sync_policy: mirror_complete
    state: present
    required: "{{ stackhpc_pulp_sync_for_local_container_build | bool and stackhpc_pulp_sync_el_8 | bool }}"

  - name: CentOS Stream 8 - PowerTools
    url: "{{ stackhpc_release_pulp_content_url }}/centos/8-stream/PowerTools/x86_64/os/{{ stackhpc_pulp_repo_centos_stream_8_powertools_version }}"
    remote_username: "{{ stackhpc_release_pulp_username }}"
    remote_password: "{{ stackhpc_release_pulp_password }}"
    client_cert: ""
    client_key: ""
    policy: on_demand
    proxy_url: "{{ pulp_proxy_url }}"
    sync_policy: mirror_complete
    state: present
    required: "{{ stackhpc_pulp_sync_for_local_container_build | bool and stackhpc_pulp_sync_el_8 | bool }}"

  - name: CentOS 8 - OpsTools - collectd
    url: "{{ stackhpc_release_pulp_content_url }}/centos/8-stream/opstools/x86_64/collectd-5/{{ stackhpc_pulp_repo_centos_stream_8_opstools_version }}"
    remote_username: "{{ stackhpc_release_pulp_username }}"
    remote_password: "{{ stackhpc_release_pulp_password }}"
    client_cert: ""
    client_key: ""
    policy: on_demand
    proxy_url: "{{ pulp_proxy_url }}"
    sync_policy: mirror_complete
    state: present
    required: "{{ stackhpc_pulp_sync_for_local_container_build | bool and stackhpc_pulp_sync_el_8 | bool }}"

  - name: CentOS Stream 8 - Ceph Pacific
    url: "{{ stackhpc_release_pulp_content_url }}/centos/8-stream/storage/x86_64/ceph-pacific/{{ stackhpc_pulp_repo_centos_stream_8_storage_ceph_pacific_version }}"
    remote_username: "{{ stackhpc_release_pulp_username }}"
    remote_password: "{{ stackhpc_release_pulp_password }}"
    client_cert: ""
    client_key: ""
    policy: on_demand
    proxy_url: "{{ pulp_proxy_url }}"
    sync_policy: mirror_complete
    state: present
    required: "{{ stackhpc_pulp_sync_for_local_container_build | bool and stackhpc_pulp_sync_el_8 | bool }}"

  - name: ELK repository for 7.x packages
    url: "{{ stackhpc_release_pulp_content_url }}/elasticsearch/oss-7.x/{{ stackhpc_pulp_repo_elasticsearch_logstash_kibana_7_x_version }}"
    remote_username: "{{ stackhpc_release_pulp_username }}"
    remote_password: "{{ stackhpc_release_pulp_password }}"
    client_cert: ""
    client_key: ""
    policy: on_demand
    proxy_url: "{{ pulp_proxy_url }}"
    sync_policy: mirror_complete
    state: present
    required: "{{ stackhpc_pulp_sync_for_local_container_build | bool and stackhpc_pulp_sync_el_8 | bool }}"

  - name: Grafana
    url: "{{ stackhpc_release_pulp_content_url }}/grafana/oss/rpm/{{ stackhpc_pulp_repo_grafana_version }}"
    remote_username: "{{ stackhpc_release_pulp_username }}"
    remote_password: "{{ stackhpc_release_pulp_password }}"
    client_cert: ""
    client_key: ""
    policy: on_demand
    proxy_url: "{{ pulp_proxy_url }}"
    sync_policy: mirror_complete
    state: present
    required: "{{ stackhpc_pulp_sync_for_local_container_build | bool and ( stackhpc_pulp_sync_el_8 | bool or stackhpc_pulp_sync_el_9 | bool ) }}"

  - name: RabbitMQ - Erlang
    url: "{{ stackhpc_release_pulp_content_url }}/rabbitmq/erlang/el/8/x86_64/{{ stackhpc_pulp_repo_rabbitmq_erlang_version }}"
    remote_username: "{{ stackhpc_release_pulp_username }}"
    remote_password: "{{ stackhpc_release_pulp_password }}"
    client_cert: ""
    client_key: ""
    policy: on_demand
    proxy_url: "{{ pulp_proxy_url }}"
    sync_policy: mirror_complete
    state: present
    required: "{{ stackhpc_pulp_sync_for_local_container_build | bool and ( stackhpc_pulp_sync_el_8 | bool or stackhpc_pulp_sync_el_9 | bool ) }}"

  - name: RabbitMQ - Server
    url: "{{ stackhpc_release_pulp_content_url }}/rabbitmq/rabbitmq-server/el/8/x86_64/{{ stackhpc_pulp_repo_rabbitmq_server_version }}"
    remote_username: "{{ stackhpc_release_pulp_username }}"
    remote_password: "{{ stackhpc_release_pulp_password }}"
    client_cert: ""
    client_key: ""
    policy: on_demand
    proxy_url: "{{ pulp_proxy_url }}"
    sync_policy: mirror_complete
    state: present
    required: "{{ stackhpc_pulp_sync_for_local_container_build | bool and ( stackhpc_pulp_sync_el_8 | bool or stackhpc_pulp_sync_el_9 | bool ) }}"

  - name: TreasureData 4
    url: "{{ stackhpc_release_pulp_content_url }}/treasuredata/4/redhat/8/x86_64/{{ stackhpc_pulp_repo_treasuredata_4_version }}"
    remote_username: "{{ stackhpc_release_pulp_username }}"
    remote_password: "{{ stackhpc_release_pulp_password }}"
    client_cert: ""
    client_key: ""
    policy: on_demand
    proxy_url: "{{ pulp_proxy_url }}"
    sync_policy: mirror_complete
    state: present
    required: "{{ stackhpc_pulp_sync_for_local_container_build | bool and stackhpc_pulp_sync_el_8 | bool }}"

  # Base Rocky 9 repositories
  - name: Rocky Linux 9 - AppStream
    url: "{{ stackhpc_release_pulp_content_url }}/rocky/9.{{ stackhpc_pulp_repo_rocky_9_minor_version }}/AppStream/x86_64/os/{{ stackhpc_pulp_repo_rocky_9_appstream_version }}"
    remote_username: "{{ stackhpc_release_pulp_username }}"
    remote_password: "{{ stackhpc_release_pulp_password }}"
    policy: on_demand
    proxy_url: "{{ pulp_proxy_url }}"
    sync_policy: mirror_complete
    state: present
    required: "{{ stackhpc_pulp_sync_rocky_9 | bool }}"
  - name: Rocky Linux 9 - BaseOS
    url: "{{ stackhpc_release_pulp_content_url }}/rocky/9.{{ stackhpc_pulp_repo_rocky_9_minor_version }}/BaseOS/x86_64/os/{{ stackhpc_pulp_repo_rocky_9_baseos_version }}"
    remote_username: "{{ stackhpc_release_pulp_username }}"
    remote_password: "{{ stackhpc_release_pulp_password }}"
    policy: on_demand
    proxy_url: "{{ pulp_proxy_url }}"
    sync_policy: mirror_complete
    state: present
    required: "{{ stackhpc_pulp_sync_rocky_9 | bool }}"
  - name: Rocky Linux 9 - Extras
    url: "{{ stackhpc_release_pulp_content_url }}/rocky/9.{{ stackhpc_pulp_repo_rocky_9_minor_version }}/extras/x86_64/os/{{ stackhpc_pulp_repo_rocky_9_extras_version }}"
    remote_username: "{{ stackhpc_release_pulp_username }}"
    remote_password: "{{ stackhpc_release_pulp_password }}"
    policy: on_demand
    proxy_url: "{{ pulp_proxy_url }}"
    sync_policy: mirror_complete
    state: present
    required: "{{ stackhpc_pulp_sync_rocky_9 | bool }}"
  - name: Rocky Linux 9 - CRB
    url: "{{ stackhpc_release_pulp_content_url }}/rocky/9.{{ stackhpc_pulp_repo_rocky_9_minor_version }}/CRB/x86_64/os/{{ stackhpc_pulp_repo_rocky_9_crb_version }}"
    remote_username: "{{ stackhpc_release_pulp_username }}"
    remote_password: "{{ stackhpc_release_pulp_password }}"
    policy: on_demand
    proxy_url: "{{ pulp_proxy_url }}"
    sync_policy: mirror_complete
    state: present
    required: "{{ stackhpc_pulp_sync_rocky_9 | bool }}"
  - name: Rocky Linux 9 - HighAvailability
    url: "{{ stackhpc_release_pulp_content_url }}/rocky/9.{{ stackhpc_pulp_repo_rocky_9_minor_version }}/highavailability/x86_64/os/{{ stackhpc_pulp_repo_rocky_9_highavailability_version }}"
    remote_username: "{{ stackhpc_release_pulp_username }}"
    remote_password: "{{ stackhpc_release_pulp_password }}"
    policy: on_demand
    proxy_url: "{{ pulp_proxy_url }}"
    sync_policy: mirror_complete
    state: present
    required: "{{ stackhpc_pulp_sync_rocky_9 | bool }}"

  # Additional CentOS Stream 9 repositories
  - name: CentOS Stream 9 - NFV OpenvSwitch
    url: "{{ stackhpc_release_pulp_content_url }}/centos/9-stream/nfv/x86_64/openvswitch-2/{{ stackhpc_pulp_repo_centos_stream_9_nfv_openvswitch_version }}"
    remote_username: "{{ stackhpc_release_pulp_username }}"
    remote_password: "{{ stackhpc_release_pulp_password }}"
    policy: on_demand
    proxy_url: "{{ pulp_proxy_url }}"
    sync_policy: mirror_complete
    state: present
    required: "{{ stackhpc_pulp_sync_for_local_container_build | bool and stackhpc_pulp_sync_el_9 | bool }}"
  - name: CentOS Stream 9 - OpenStack Yoga
    url: "{{ stackhpc_release_pulp_content_url }}/centos/9-stream/cloud/x86_64/openstack-yoga/{{ stackhpc_pulp_repo_centos_stream_9_openstack_yoga_version }}"
    remote_username: "{{ stackhpc_release_pulp_username }}"
    remote_password: "{{ stackhpc_release_pulp_password }}"
    client_cert: ""
    client_key: ""
    policy: on_demand
    proxy_url: "{{ pulp_proxy_url }}"
    sync_policy: mirror_complete
    state: present
    required: "{{ stackhpc_pulp_sync_for_local_container_build | bool and stackhpc_pulp_sync_el_9 | bool }}"
  - name: CentOS 9 - OpsTools - collectd
    url: "{{ stackhpc_release_pulp_content_url }}/centos/9-stream/opstools/x86_64/collectd-5/{{ stackhpc_pulp_repo_centos_stream_9_opstools_version }}"
    remote_username: "{{ stackhpc_release_pulp_username }}"
    remote_password: "{{ stackhpc_release_pulp_password }}"
    policy: on_demand
    proxy_url: "{{ pulp_proxy_url }}"
    sync_policy: mirror_complete
    state: present
    required: "{{ stackhpc_pulp_sync_for_local_container_build | bool and stackhpc_pulp_sync_el_9 | bool }}"
  - name: CentOS Stream 9 - Ceph Pacific
    url: "{{ stackhpc_release_pulp_content_url }}/centos/9-stream/storage/x86_64/ceph-pacific/{{ stackhpc_pulp_repo_centos_stream_9_storage_ceph_pacific_version }}"
    remote_username: "{{ stackhpc_release_pulp_username }}"
    remote_password: "{{ stackhpc_release_pulp_password }}"
    policy: on_demand
    proxy_url: "{{ pulp_proxy_url }}"
    sync_policy: mirror_complete
    state: present
    required: "{{ stackhpc_pulp_sync_for_local_container_build | bool and stackhpc_pulp_sync_el_9 | bool }}"
  - name: Extra Packages for Enterprise Linux 9 - x86_64
    url: "{{ stackhpc_release_pulp_content_url }}/epel/9/Everything/x86_64/{{ stackhpc_pulp_repo_epel_9_version }}"
    remote_username: "{{ stackhpc_release_pulp_username }}"
    remote_password: "{{ stackhpc_release_pulp_password }}"
    policy: on_demand
    proxy_url: "{{ pulp_proxy_url }}"
    sync_policy: mirror_content_only
    state: present
    required: "{{ stackhpc_pulp_sync_el_9 | bool }}"
  - name: Docker CE for CentOS 9
    url: "{{ stackhpc_release_pulp_content_url }}/docker-ce/centos/9/x86_64/stable/{{ stackhpc_pulp_repo_centos_stream_9_docker_version }}"
    remote_username: "{{ stackhpc_release_pulp_username }}"
    remote_password: "{{ stackhpc_release_pulp_password }}"
    policy: on_demand
    proxy_url: "{{ pulp_proxy_url }}"
    sync_policy: mirror_complete
    state: present
    required: "{{ stackhpc_pulp_sync_el_9 }}"

  # Additional RHEL 9 repositories
  - name: TreasureData 4 for RHEL 9
    url: "{{ stackhpc_release_pulp_content_url }}/treasuredata/4/redhat/9/x86_64/{{ stackhpc_pulp_repo_rhel_9_treasuredata_4_version }}"
    remote_username: "{{ stackhpc_release_pulp_username }}"
    remote_password: "{{ stackhpc_release_pulp_password }}"
    policy: on_demand
    proxy_url: "{{ pulp_proxy_url }}"
    sync_policy: mirror_complete
    state: present
    required: "{{ stackhpc_pulp_sync_for_local_container_build | bool and stackhpc_pulp_sync_el_9 | bool }}"
  - name: MariaDB 10.6 for RHEL 9
    url: "{{ stackhpc_release_pulp_content_url }}/mariadb-10.6/yum/rhel/9/x86_64/{{ stackhpc_pulp_repo_rhel_9_mariadb_10_6_version }}"
    remote_username: "{{ stackhpc_release_pulp_username }}"
    remote_password: "{{ stackhpc_release_pulp_password }}"
    policy: on_demand
    proxy_url: "{{ pulp_proxy_url }}"
    sync_policy: mirror_complete
    state: present
    required: "{{ stackhpc_pulp_sync_for_local_container_build | bool and stackhpc_pulp_sync_el_9 | bool }}"
  - name: InfluxDB for RHEL 9
    url: "{{ stackhpc_release_pulp_content_url }}/influxdb/rhel/9/x86_64/stable/{{ stackhpc_pulp_repo_rhel_9_influxdb_version }}"
    remote_username: "{{ stackhpc_release_pulp_username }}"
    remote_password: "{{ stackhpc_release_pulp_password }}"
    policy: on_demand
    proxy_url: "{{ pulp_proxy_url }}"
    sync_policy: mirror_complete
    state: present
    required: "{{ stackhpc_pulp_sync_for_local_container_build | bool and stackhpc_pulp_sync_el_9 | bool }}"


# Publication format is a subset of distribution.
stackhpc_pulp_publication_rpm_development: "{{ stackhpc_pulp_distribution_rpm_development }}"

# Content is made available at well-known distribution names for development,
# production.

# Development tracks the release repositories.
stackhpc_pulp_distribution_rpm_development:
  # Base CentOS 8 Stream repositories
  - name: "centos-stream-8-appstream-development"
    repository: CentOS Stream 8 - AppStream
    base_path: "centos/8-stream/AppStream/x86_64/os/development"
    state: present
    required: "{{ stackhpc_pulp_sync_centos_stream8 | bool }}"
  - name: "centos-stream-8-baseos-development"
    repository: CentOS Stream 8 - BaseOS
    base_path: "centos/8-stream/BaseOS/x86_64/os/development"
    state: present
    required: "{{ stackhpc_pulp_sync_centos_stream8 | bool }}"
  - name: "centos-stream-8-extras-development"
    repository: CentOS Stream 8 - Extras
    base_path: "centos/8-stream/extras/x86_64/os/development"
    state: present
    required: "{{ stackhpc_pulp_sync_centos_stream8 | bool }}"

  # Base Rocky 8 repositories
  - name: "rocky-8-appstream-development"
    repository: Rocky Linux 8 - AppStream
    base_path: "rocky/8/AppStream/x86_64/os/development"
    state: present
    required: "{{ stackhpc_pulp_sync_rocky_8 | bool }}"
  - name: "rocky-8-baseos-development"
    repository: Rocky Linux 8 - BaseOS
    base_path: "rocky/8/BaseOS/x86_64/os/development"
    state: present
    required: "{{ stackhpc_pulp_sync_rocky_8 | bool }}"
  - name: "rocky-8-extras-development"
    repository: Rocky Linux 8 - Extras
    base_path: "rocky/8/extras/x86_64/os/development"
    state: present
    required: "{{ stackhpc_pulp_sync_rocky_8 | bool }}"
  - name: "rocky-8-nfv-development"
    repository: Rocky Linux 8 - NFV
    base_path: "rocky/8/nfv/x86_64/os/development"
    state: present
    required: "{{ stackhpc_pulp_sync_rocky_8 | bool }}"
  - name: "rocky-powertools-development"
    repository: Rocky Linux 8 - PowerTools
    base_path: "rocky/8/PowerTools/x86_64/os/development"
    state: present
    required: "{{ stackhpc_pulp_sync_rocky_8 | bool }}"

  # EPEL 8 repositories
  - name: "extra-packages-for-enterprise-linux-8-x86_64-development"
    repository: Extra Packages for Enterprise Linux 8 - x86_64
    base_path: "epel/8/Everything/x86_64/development"
    state: present
    required: "{{ stackhpc_pulp_sync_el_8 | bool }}"
  - name: "extra-packages-for-enterprise-linux-modular-8-x86_64-development"
    repository: Extra Packages for Enterprise Linux Modular 8 - x86_64
    base_path: "epel/8/Modular/x86_64/development"
    state: present
    required: "{{ stackhpc_pulp_sync_el_8 | bool }}"

  # Third-party repositories
  - name: "docker-ce-for-centos-8-development"
    repository: Docker CE for CentOS 8
    base_path: "docker-ce/centos/8/x86_64/stable/development"
    state: present
    required: "{{ stackhpc_pulp_sync_el_8 | bool }}"

  # Additional repositories required to build Kolla containers from local Pulp service.
  - name: "centos-stream-8-openstack-yoga-development"
    base_path: "centos/8-stream/cloud/x86_64/openstack-yoga/development"
    repository: CentOS Stream 8 - OpenStack Yoga
    state: present
    required: "{{ stackhpc_pulp_sync_for_local_container_build | bool and stackhpc_pulp_sync_el_8 | bool }}"
  - name: "centos-stream-8-advanced-virtualization-development"
    base_path: "centos/8-stream/virt/x86_64/advancedvirt-common/development"
    repository: CentOS Stream 8 - Advanced Virtualization
    state: present
    required: "{{ stackhpc_pulp_sync_for_local_container_build | bool and stackhpc_pulp_sync_el_8 | bool }}"
  - name: "centos-stream-8-nfv-openvswitch-development"
    base_path: "centos/8-stream/nfv/x86_64/openvswitch-2/development"
    repository: CentOS Stream 8 - NFV OpenvSwitch
    state: present
    required: "{{ stackhpc_pulp_sync_for_local_container_build | bool and stackhpc_pulp_sync_el_8 | bool }}"
  - name: "centos-stream-8-powertools-development"
    base_path: "centos/8-stream/PowerTools/x86_64/os/development"
    repository: CentOS Stream 8 - PowerTools
    state: present
    required: "{{ stackhpc_pulp_sync_for_local_container_build | bool and stackhpc_pulp_sync_el_8 | bool }}"
  - name: "centos-8-opstools-collectd-development"
    base_path: "centos/8-stream/opstools/x86_64/collectd-5/development"
    repository: CentOS 8 - OpsTools - collectd
    state: present
    required: "{{ stackhpc_pulp_sync_for_local_container_build | bool and stackhpc_pulp_sync_el_8 | bool }}"
  - name: "centos-stream-8-ceph-pacific-development"
    base_path: "centos/8-stream/storage/x86_64/ceph-pacific/development"
    repository: CentOS Stream 8 - Ceph Pacific
    state: present
    required: "{{ stackhpc_pulp_sync_for_local_container_build | bool and stackhpc_pulp_sync_el_8 | bool }}"
  - name: "elasticsearch-logstash-kibana-7.x-development"
    base_path: "elasticsearch/oss-7.x/development"
    repository: ELK repository for 7.x packages
    state: present
    required: "{{ stackhpc_pulp_sync_for_local_container_build | bool and stackhpc_pulp_sync_el_8 | bool }}"
  - name: "grafana-development"
    base_path: "grafana/oss/rpm/development"
    repository: Grafana
    state: present
    required: "{{ stackhpc_pulp_sync_for_local_container_build | bool and stackhpc_pulp_sync_el_8 | bool }}"
  - name: "rabbitmq-erlang-development"
    base_path: "rabbitmq/erlang/el/8/x86_64/development"
    repository: RabbitMQ - Erlang
    state: present
    required: "{{ stackhpc_pulp_sync_for_local_container_build | bool and ( stackhpc_pulp_sync_el_8 | bool or stackhpc_pulp_sync_el_9 | bool ) }}"
  - name: "rabbitmq-server-development"
    base_path: "rabbitmq/rabbitmq-server/el/8/x86_64/development"
    repository: RabbitMQ - Server
    state: present
    required: "{{ stackhpc_pulp_sync_for_local_container_build | bool and ( stackhpc_pulp_sync_el_8 | bool or stackhpc_pulp_sync_el_9 | bool ) }}"
  - name: "treasuredata-4-development"
    base_path: "treasuredata/4/redhat/8/x86_64/development"
    repository: TreasureData 4
    state: present
    required: "{{ stackhpc_pulp_sync_for_local_container_build | bool and stackhpc_pulp_sync_el_8 | bool }}"

  # Base Rocky Linux 9 repositories
  - name: "rocky-9-appstream-development"
    repository: Rocky Linux 9 - AppStream
    base_path: "rocky/9/AppStream/x86_64/os/development"
    state: present
    required: "{{ stackhpc_pulp_sync_rocky_9 | bool }}"
  - name: "rocky-9-baseos-development"
    repository: Rocky Linux 9 - BaseOS
    base_path: "rocky/9/BaseOS/x86_64/os/development"
    state: present
    required: "{{ stackhpc_pulp_sync_rocky_9 | bool }}"
  - name: "rocky-9-extras-development"
    repository: Rocky Linux 9 - Extras
    base_path: "rocky/9/extras/x86_64/os/development"
    state: present
    required: "{{ stackhpc_pulp_sync_rocky_9 | bool }}"
  - name: "rocky-9-crb-development"
    repository: Rocky Linux 9 - CRB
    base_path: "rocky/9/CRB/x86_64/os/development"
    state: present
    required: "{{ stackhpc_pulp_sync_rocky_9 | bool }}"
  - name: "rocky-9-highavailability-development"
    repository: Rocky Linux 9 - HighAvailability
    base_path: "rocky/9/highavailability/x86_64/os/development"
    state: present
    required: "{{ stackhpc_pulp_sync_rocky_9 | bool }}"

  # Additional CentOS Stream 9 repositories
  - name: "centos-stream-9-nfv-openvswitch-development"
    base_path: "centos/9-stream/nfv/x86_64/openvswitch-2/development"
    repository: CentOS Stream 9 - NFV OpenvSwitch
    state: present
    required: "{{ stackhpc_pulp_sync_for_local_container_build | bool and stackhpc_pulp_sync_el_9 | bool }}"
  - name: "centos-stream-9-openstack-yoga-development"
    base_path: "centos/9-stream/cloud/x86_64/openstack-yoga/development"
    repository: CentOS Stream 9 - OpenStack Yoga
    state: present
    required: "{{ stackhpc_pulp_sync_for_local_container_build | bool and stackhpc_pulp_sync_el_9 | bool }}"
  - name: "centos-9-opstools-collectd-development"
    base_path: "centos/9-stream/opstools/x86_64/collectd-5/development"
    repository: CentOS 9 - OpsTools - collectd
    state: present
    required: "{{ stackhpc_pulp_sync_for_local_container_build | bool and stackhpc_pulp_sync_el_9 | bool }}"
  - name: "centos-stream-9-ceph-pacific-development"
    base_path: "centos/9-stream/storage/x86_64/ceph-pacific/development"
    repository: CentOS Stream 9 - Ceph Pacific
    state: present
    required: "{{ stackhpc_pulp_sync_for_local_container_build | bool and stackhpc_pulp_sync_el_9 | bool }}"
  - name: "extra-packages-for-enterprise-linux-9-x86_64-development"
    repository: Extra Packages for Enterprise Linux 9 - x86_64
    base_path: "epel/9/Everything/x86_64/development"
    state: present
    required: "{{ stackhpc_pulp_sync_el_9 | bool }}"
  - name: "docker-ce-for-centos-9-development"
    repository: Docker CE for CentOS 9
    base_path: "docker-ce/centos/9/x86_64/stable/development"
    state: present
    required: "{{ stackhpc_pulp_sync_el_9 | bool }}"

  # Additional RHEL 9 repositories
  - name: "rhel-9-treasuredata-4-development"
    base_path: "treasuredata/4/redhat/9/x86_64/development"
    repository: TreasureData 4 for RHEL 9
    state: present
    required: "{{ stackhpc_pulp_sync_for_local_container_build | bool and stackhpc_pulp_sync_el_9 | bool }}"
  - name: "rhel-9-mariadb-10-6-development"
    base_path: "mariadb-10.6/yum/rhel/9/x86_64/development"
    repository: MariaDB 10.6 for RHEL 9
    state: present
    required: "{{ stackhpc_pulp_sync_for_local_container_build | bool and stackhpc_pulp_sync_el_9 | bool }}"
  - name: "rhel-9-influxdb-development"
    base_path: "influxdb/rhel/9/x86_64/stable/development"
    repository: InfluxDB for RHEL 9
    state: present
    required: "{{ stackhpc_pulp_sync_for_local_container_build | bool and stackhpc_pulp_sync_el_9 | bool }}"


# Development gets promoted to production.
stackhpc_pulp_distribution_rpm_production:
  # Base CentOS 8 Stream repositories
  - name: "centos-stream-8-baseos-production"
    base_path: "centos/8-stream/BaseOS/x86_64/os/production"
    distribution: "centos-stream-8-baseos-development"
    state: present
    required: "{{ stackhpc_pulp_sync_centos_stream8 | bool }}"
  - name: "centos-stream-8-appstream-production"
    base_path: "centos/8-stream/AppStream/x86_64/os/production"
    distribution: "centos-stream-8-appstream-development"
    state: present
    required: "{{ stackhpc_pulp_sync_centos_stream8 | bool }}"
  - name: "centos-stream-8-extras-production"
    base_path: "centos/8-stream/extras/x86_64/os/production"
    distribution: "centos-stream-8-extras-development"
    state: present
    required: "{{ stackhpc_pulp_sync_centos_stream8 | bool }}"

  # Base Rocky 8 repositories
  - name: "rocky-8-appstream-production"
    distribution: "rocky-8-appstream-development"
    base_path: "rocky/8/AppStream/x86_64/os/production"
    state: present
    required: "{{ stackhpc_pulp_sync_rocky_8 | bool }}"
  - name: "rocky-8-baseos-production"
    distribution: "rocky-8-baseos-development"
    base_path: "rocky/8/BaseOS/x86_64/os/production"
    state: present
    required: "{{ stackhpc_pulp_sync_rocky_8 | bool }}"
  - name: "rocky-8-extras-production"
    distribution: "rocky-8-extras-development"
    base_path: "rocky/8/extras/x86_64/os/production"
    state: present
    required: "{{ stackhpc_pulp_sync_rocky_8 | bool }}"
  - name: "rocky-8-nfv-production"
    distribution: "rocky-8-nfv-development"
    base_path: "rocky/8/nfv/x86_64/os/production"
    state: present
    required: "{{ stackhpc_pulp_sync_rocky_8 | bool }}"
  - name: "rocky-8-powertools-production"
    distribution: "rocky-8-powertools-development"
    base_path: "rocky/8/PowerTools/x86_64/os/production"
    state: present
    required: "{{ stackhpc_pulp_sync_rocky_8 | bool }}"

  # EPEL repositories
  - name: "extra-packages-for-enterprise-linux-8-x86_64-production"
    base_path: "epel/8/Everything/x86_64/production"
    distribution: "extra-packages-for-enterprise-linux-8-x86_64-development"
    state: present
    required: "{{ stackhpc_pulp_sync_el_8 | bool }}"
  - name: "extra-packages-for-enterprise-linux-modular-8-x86_64-production"
    base_path: "epel/8/Modular/x86_64/production"
    distribution: "extra-packages-for-enterprise-linux-modular-8-x86_64-development"
    state: present
    required: "{{ stackhpc_pulp_sync_el_8 | bool }}"

  # Third-party repositories
  - name: "docker-ce-for-centos-8-production"
    base_path: "docker-ce/centos/8/x86_64/stable/production"
    distribution: "docker-ce-for-centos-8-development"
    state: present
    required: "{{ stackhpc_pulp_sync_el_8 | bool }}"

  # Additional repositories required to build Kolla containers from local Pulp service.
  - name: "centos-stream-8-openstack-yoga-production"
    base_path: "centos/8-stream/cloud/x86_64/openstack-yoga/production"
    repository: CentOS Stream 8 - OpenStack Yoga
    state: present
    required: "{{ stackhpc_pulp_sync_for_local_container_build | bool and stackhpc_pulp_sync_el_8 | bool }}"
  - name: "centos-stream-8-advanced-virtualization-production"
    base_path: "centos/8-stream/virt/x86_64/advancedvirt-common/production"
    repository: CentOS Stream 8 - Advanced Virtualization
    state: present
    required: "{{ stackhpc_pulp_sync_for_local_container_build | bool and stackhpc_pulp_sync_el_8 | bool }}"
  - name: "centos-stream-8-nfv-openvswitch-production"
    base_path: "centos/8-stream/nfv/x86_64/openvswitch-2/production"
    repository: CentOS Stream 8 - NFV OpenvSwitch
    state: present
    required: "{{ stackhpc_pulp_sync_for_local_container_build | bool and stackhpc_pulp_sync_el_8 | bool }}"
  - name: "centos-stream-8-powertools-production"
    base_path: "centos/8-stream/PowerTools/x86_64/os/production"
    repository: CentOS Stream 8 - PowerTools
    state: present
    required: "{{ stackhpc_pulp_sync_for_local_container_build | bool and stackhpc_pulp_sync_el_8 | bool }}"
  - name: "centos-8-opstools-collectd-production"
    base_path: "centos/8-stream/opstools/x86_64/collectd-5/production"
    repository: CentOS 8 - OpsTools - collectd
    state: present
    required: "{{ stackhpc_pulp_sync_for_local_container_build | bool and stackhpc_pulp_sync_el_8 | bool }}"
  - name: "centos-stream-8-ceph-pacific-production"
    base_path: "centos/8-stream/storage/x86_64/ceph-pacific/production"
    repository: CentOS Stream 8 - Ceph Pacific
    state: present
    required: "{{ stackhpc_pulp_sync_for_local_container_build | bool and stackhpc_pulp_sync_el_8 | bool }}"
  - name: "elasticsearch-logstash-kibana-7.x-production"
    base_path: "elasticsearch/oss-7.x/production"
    repository: ELK repository for 7.x packages
    state: present
    required: "{{ stackhpc_pulp_sync_for_local_container_build | bool and stackhpc_pulp_sync_el_8 | bool }}"
  - name: "grafana-production"
    base_path: "grafana/oss/rpm/production"
    repository: Grafana
    state: present
    required: "{{ stackhpc_pulp_sync_for_local_container_build | bool and stackhpc_pulp_sync_el_8 | bool }}"
  - name: "rabbitmq-erlang-production"
    base_path: "rabbitmq/erlang/el/8/x86_64/production"
    repository: RabbitMQ - Erlang
    state: present
    required: "{{ stackhpc_pulp_sync_for_local_container_build | bool and ( stackhpc_pulp_sync_el_8 | bool or stackhpc_pulp_sync_el_9 | bool ) }}"
  - name: "rabbitmq-server-production"
    base_path: "rabbitmq/rabbitmq-server/el/8/x86_64/production"
    repository: RabbitMQ - Server
    state: present
    required: "{{ stackhpc_pulp_sync_for_local_container_build | bool and ( stackhpc_pulp_sync_el_8 | bool or stackhpc_pulp_sync_el_9 | bool ) }}"
  - name: "treasuredata-4-production"
    base_path: "treasuredata/4/redhat/8/x86_64/production"
    repository: TreasureData 4
    state: present
    required: "{{ stackhpc_pulp_sync_for_local_container_build | bool and stackhpc_pulp_sync_el_8 | bool }}"

  # Base Rocky Linux 9 repositories
  - name: "rocky-9-appstream-production"
    repository: Rocky Linux 9 - AppStream
    base_path: "rocky/9/AppStream/x86_64/os/production"
    state: present
    required: "{{ stackhpc_pulp_sync_rocky_9 | bool }}"
  - name: "rocky-9-baseos-production"
    repository: Rocky Linux 9 - BaseOS
    base_path: "rocky/9/BaseOS/x86_64/os/production"
    state: present
    required: "{{ stackhpc_pulp_sync_rocky_9 | bool }}"
  - name: "rocky-9-extras-production"
    repository: Rocky Linux 9 - Extras
    base_path: "rocky/9/extras/x86_64/os/production"
    state: present
    required: "{{ stackhpc_pulp_sync_rocky_9 | bool }}"
  - name: "rocky-9-crb-production"
    repository: Rocky Linux 9 - CRB
    base_path: "rocky/9/CRB/x86_64/os/production"
    state: present
    required: "{{ stackhpc_pulp_sync_rocky_9 | bool }}"
  - name: "rocky-9-highavailability-production"
    repository: Rocky Linux 9 - HighAvailability
    base_path: "rocky/9/highavailability/x86_64/os/production"
    state: present
    required: "{{ stackhpc_pulp_sync_rocky_9 | bool }}"

  # Additional CentOS Stream 9 repositories
  - name: "centos-stream-9-nfv-openvswitch-production"
    base_path: "centos/9-stream/nfv/x86_64/openvswitch-2/production"
    repository: CentOS Stream 9 - NFV OpenvSwitch
    state: present
    required: "{{ stackhpc_pulp_sync_for_local_container_build | bool and stackhpc_pulp_sync_el_9 | bool }}"
  - name: "centos-stream-9-openstack-yoga-production"
    base_path: "centos/9-stream/cloud/x86_64/openstack-yoga/production"
    repository: CentOS Stream 9 - OpenStack Yoga
    state: present
    required: "{{ stackhpc_pulp_sync_for_local_container_build | bool and stackhpc_pulp_sync_el_9 | bool }}"
  - name: "centos-9-opstools-collectd-production"
    base_path: "centos/9-stream/opstools/x86_64/collectd-5/production"
    repository: CentOS 9 - OpsTools - collectd
    state: present
    required: "{{ stackhpc_pulp_sync_for_local_container_build | bool and stackhpc_pulp_sync_el_9 | bool }}"
  - name: "centos-stream-9-ceph-pacific-production"
    base_path: "centos/9-stream/storage/x86_64/ceph-pacific/production"
    repository: CentOS Stream 9 - Ceph Pacific
    state: present
    required: "{{ stackhpc_pulp_sync_for_local_container_build | bool and stackhpc_pulp_sync_el_9 | bool }}"
  - name: "extra-packages-for-enterprise-linux-9-x86_64-production"
    repository: Extra Packages for Enterprise Linux 9 - x86_64
    base_path: "epel/9/Everything/x86_64/production"
    state: present
    required: "{{ stackhpc_pulp_sync_el_9 | bool }}"
  - name: "docker-ce-for-centos-9-production"
    repository: Docker CE for CentOS 9
    base_path: "docker-ce/centos/9/x86_64/stable/production"
    state: present
    required: "{{ stackhpc_pulp_sync_el_9 | bool }}"

  # Additional RHEL 9 repositories
  - name: "rhel-9-treasuredata-4-production"
    base_path: "treasuredata/4/redhat/9/x86_64/production"
    repository: TreasureData 4 for RHEL 9
    state: present
    required: "{{ stackhpc_pulp_sync_for_local_container_build | bool and stackhpc_pulp_sync_el_9 | bool }}"
  - name: "rhel-9-mariadb-10-6-production"
    base_path: "mariadb-10.6/yum/rhel/9/x86_64/production"
    repository: MariaDB 10.6 for RHEL 9
    state: present
    required: "{{ stackhpc_pulp_sync_for_local_container_build | bool and stackhpc_pulp_sync_el_9 | bool }}"
  - name: "rhel-9-influxdb-production"
    base_path: "influxdb/rhel/9/x86_64/stable/production"
    repository: InfluxDB for RHEL 9
    state: present
    required: "{{ stackhpc_pulp_sync_for_local_container_build | bool and stackhpc_pulp_sync_el_9 | bool }}"

###############################################################################
# Containers

# URL of the StackHPC Pulp service's container image registry.
stackhpc_release_pulp_registry_url: "{{ stackhpc_release_pulp_url }}"

# List of all image names.
stackhpc_pulp_images_kolla:
  - barbican-api
  - barbican-keystone-listener
  - barbican-worker
  - bifrost-deploy
  - blazar-api
  - blazar-manager
  - cinder-api
  - cinder-backup
  - cinder-scheduler
  - cinder-volume
  - cloudkitty-api
  - cloudkitty-processor
  - cron
  - designate-api
  - designate-backend-bind9
  - designate-central
  - designate-mdns
  - designate-producer
  - designate-sink
  - designate-worker
  - dnsmasq
  - elasticsearch
  - elasticsearch-curator
  - etcd
  - fluentd
  - glance-api
  - grafana
  - haproxy
  - heat-api
  - heat-api-cfn
  - heat-engine
  - horizon
  - influxdb
  - ironic-api
  - ironic-conductor
  - ironic-inspector
  - ironic-neutron-agent
  - ironic-pxe
  - iscsid
  - keepalived
  - keystone
  - keystone-fernet
  - keystone-ssh
  - kibana
  - kolla-toolbox
  - magnum-api
  - magnum-conductor
  - manila-api
  - manila-data
  - manila-scheduler
  - manila-share
  - mariadb-clustercheck
  - mariadb-server
  - memcached
  - neutron-dhcp-agent
  - neutron-l3-agent
  - neutron-metadata-agent
  - neutron-openvswitch-agent
  - neutron-server
  - neutron-sriov-agent
  - nova-api
  - nova-compute
  - nova-compute-ironic
  - nova-conductor
  - nova-libvirt
  - nova-novncproxy
  - nova-scheduler
  - nova-serialproxy
  - nova-ssh
  - octavia-api
  - octavia-driver-agent
  - octavia-health-manager
  - octavia-housekeeping
  - octavia-worker
  - opensearch
  - opensearch-dashboards
  - openvswitch-db-server
  - openvswitch-netcontrold
  - openvswitch-vswitchd
  - ovn-controller
  - ovn-nb-db-server
  - ovn-northd
  - ovn-sb-db-server
  - placement-api
  - prometheus-alertmanager
  - prometheus-blackbox-exporter
  - prometheus-cadvisor
  - prometheus-elasticsearch-exporter
  - prometheus-haproxy-exporter
  - prometheus-jiralert
  - prometheus-libvirt-exporter
  - prometheus-memcached-exporter
  - prometheus-msteams
  - prometheus-mtail
  - prometheus-mysqld-exporter
  - prometheus-node-exporter
  - prometheus-openstack-exporter
  - prometheus-v2-server
  - rabbitmq
  - redis
  - redis-sentinel
  - skydive-agent
  - skydive-analyzer

# List of images for each base distribution which should not/cannot be built.
stackhpc_kolla_unbuildable_images:
  ubuntu: []
  centos: []
  rocky:
    - elasticsearch
    - elasticsearch-curator
    - iscsid
    - kibana

# Whitespace-separated list of regular expressions matching Kolla image names.
# Usage is similar to kolla-build CLI arguments.
# Example:
# kayobe playbook run ... -e stackhpc_pulp_images_kolla_filter='"^glance nova-compute$"'
stackhpc_pulp_images_kolla_filter: ".*"

# Filtered list of Kolla container image names.
stackhpc_pulp_images_kolla_filtered: "{{ stackhpc_pulp_images_kolla | select('search', '(' ~ stackhpc_pulp_images_kolla_filter.split() | join('|') ~ ')') | list }}"

# Common parameters for container image repositories.
stackhpc_pulp_repository_container_repos_kolla_common:
  url: "{{ stackhpc_release_pulp_registry_url }}"
  policy: on_demand
  proxy_url: "{{ pulp_proxy_url }}"
  remote_username: "{{ stackhpc_release_pulp_username }}"
  remote_password: "{{ stackhpc_release_pulp_password }}"
  state: present
  required: true

# List of Kolla container image repositories.
stackhpc_pulp_repository_container_repos_kolla: >-
  {%- set repos = [] -%}
  {%- for image in stackhpc_pulp_images_kolla_filtered -%}
  {%- if image not in stackhpc_kolla_unbuildable_images[kolla_base_distro]-%}
  {%- set image_repo = kolla_docker_namespace ~ "/" ~ kolla_base_distro ~ "-" ~ kolla_install_type ~ "-" ~ image -%}
  {%- set repo = {"name": image_repo} -%}
  {%- set _ = repos.append(stackhpc_pulp_repository_container_repos_kolla_common | combine(repo)) -%}
  {%- endif -%}
  {%- endfor -%}
  {{ repos }}

# Common parameters for Kolla container image distributions.
stackhpc_pulp_distribution_container_kolla_common:
  state: present
  required: true

# List of Kolla container image distributions.
stackhpc_pulp_distribution_container_kolla: >-
  {%- set distributions = [] -%}
  {%- for image in stackhpc_pulp_images_kolla_filtered -%}
  {%- if image not in stackhpc_kolla_unbuildable_images[kolla_base_distro]-%}
  {%- set image_repo = kolla_docker_namespace ~ "/" ~ kolla_base_distro ~ "-" ~ kolla_install_type ~ "-" ~ image -%}
  {%- set distribution = {"name": image_repo, "repository": image_repo, "base_path": image_repo} -%}
  {%- set _ = distributions.append(stackhpc_pulp_distribution_container_kolla_common | combine(distribution)) -%}
  {%- endif -%}
  {%- endfor -%}
  {{ distributions }}

# Whether to sync Ceph container images.
stackhpc_sync_ceph_images: false

# List of Ceph container image repositories.
stackhpc_pulp_repository_container_repos_ceph:
  - name: "ceph/ceph"
    url: "https://quay.io"
    policy: on_demand
    proxy_url: "{{ pulp_proxy_url }}"
    state: present
    include_tags: "{{ cephadm_image_tag }}"
    required: "{{ stackhpc_sync_ceph_images | bool }}"

# List of Ceph container image distributions.
stackhpc_pulp_distribution_container_ceph:
  - name: ceph
    repository: ceph/ceph
    base_path: ceph/ceph
    state: present
    required: "{{ stackhpc_sync_ceph_images | bool }}"

# List of container image repositories.
stackhpc_pulp_repository_container_repos: >-
  {{ (stackhpc_pulp_repository_container_repos_kolla +
      stackhpc_pulp_repository_container_repos_ceph) | selectattr('required') }}

# List of container image distributions.
stackhpc_pulp_distribution_container: >-
  {{ (stackhpc_pulp_distribution_container_kolla +
      stackhpc_pulp_distribution_container_ceph) | selectattr('required') }}
